import{S as x,N as P,P as N,a as q,A as R,i as f}from"./assets/vendor-mUhAJKfp.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const p of n.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&s(p)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}})();const A="https://furniture-store-v2.b.goit.study/api/",j=".reviews-swiper",B=".review.js-review",F="../img/icons.svg",I="icon-star-fill",z="icon-star-half",H=document.querySelector(j),y=document.querySelector(B),U=`${A}${A.endsWith("/")?"":"/"}feedbacks`;function V(e){const t=Number(e)||0;return t>3.3&&t<=3.7?3.5:t>=3.8&&t<=4.2?4:Math.round(t*2)/2}function W(e){return{rate:V(e.rate??e.rating??e.stars??0),text:String(e.descr??e.comment??e.text??""),name:String(e.name??e.author??"Анонім")}}const L=(e,t="")=>`<svg class="star-icon ${t}" width="20" height="20" aria-hidden="true"><use href="${F}#${e}"></use></svg>`;function G(e){const t=Math.max(0,Math.min(5,Number(e)||0)),o=Math.floor(t),s=t-o>=.5?1:0,r=5-o-s;return`
  <div class="review-stars" data-rating="${t}" aria-label="Рейтинг ${t} з 5">
   ${Array.from({length:o},()=>L(I)).join("")}
   ${s?L(z):""}
   ${Array.from({length:r},()=>L(I,"is-empty")).join("")}
  </div>
 `}const J=({rate:e,text:t,name:o})=>`
 <li class="review-exemplar swiper-slide">
  ${G(e)}
  <p class="text-review">“${t}”</p>
  <p class="review-author">${o}</p>
 </li>
`;async function K(e=10){try{const{data:t}=await q.get(U,{params:{limit:e}}),o=(t==null?void 0:t.feedbacks)??(t==null?void 0:t.items)??(t==null?void 0:t.data)??t??[];return Array.isArray(o)?o.slice(0,e).map(W):[]}catch(t){return console.error("Помилка при завантаженні відгуків:",t),[]}}function Q(e){y&&(y.classList.add("swiper-wrapper"),y.innerHTML=e.length?e.map(J).join(""):`<li class="review-exemplar swiper-slide">
     <p class="text-review">Наразі відгуків немає.</p>
     <p class="review-author">—</p>
    </li>`)}async function X(){if(!H||!y)return;const e=await K(10);Q(e);const t=new x(j,{modules:[P,N],slidesPerView:1,slidesPerGroup:1,spaceBetween:24,watchOverflow:!0,centeredSlides:!1,loop:!1,pagination:{el:".swiper-pagination",clickable:!0,renderBullet:(o,s)=>`<button class="${s}" type="button" aria-label="Перейти до відгуку ${o+1}"></button>`},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev",disabledClass:"is-disabled"},breakpoints:{768:{slidesPerView:2,slidesPerGroup:2,spaceBetween:24},1440:{slidesPerView:3,slidesPerGroup:3,spaceBetween:32}}});setSlideWidths(t),window.addEventListener("resize",()=>setSlideWidths(t))}const m=document.querySelector(".header"),Y=document.querySelector(".burger-btn"),Z=document.querySelector(".close-btn"),D=document.querySelector(".close-btn-tablet"),ee=document.querySelector(".overlay");document.querySelector(".js-review");document.querySelector(".review-stars");document.querySelector(".button-review-left");document.querySelector(".button-review-right");document.querySelector(".swiper-wrapper");const E=document.querySelector(".furniture-categories__list"),l=document.querySelector(".products-grid.furniture-list-js"),u=document.querySelector(".furniture__load-more"),g=document.querySelector("#loader"),h=document.querySelector(".prod-modal-overlay"),c=document.querySelector(".prod-modal-window"),te=document.querySelector(".close-modal-btn"),oe=document.querySelector(".products-grid.furniture-list-js");document.querySelector(".modal-overlay");m.addEventListener("click",re);document.addEventListener("keydown",e=>{e.key==="Escape"&&m.classList.contains("menu-open")&&(m.classList.remove("menu-open"),document.body.classList.remove("no-scroll"))});function re(e){if(Y.contains(e.target))m.classList.add("menu-open"),document.body.classList.add("no-scroll");else if(Z.contains(e.target)||D.contains(e.target)||ee.contains(e.target))m.classList.remove("menu-open"),document.body.classList.remove("no-scroll");else return}window.addEventListener("resize",()=>{window.innerWidth>=1440&&m.classList.contains("menu-open")&&(m.classList.remove("menu-open"),document.body.classList.remove("no-scroll"))});document.addEventListener("DOMContentLoaded",()=>{new R("#faq-accordion",{duration:300,collapse:!0,showMultiple:!1,elementClass:"ac",triggerClass:"ac-trigger",panelClass:"ac-panel"})});const i=document.querySelector(".modal-overlay"),d=i==null?void 0:i.querySelector(".modal-form");let w={};function se({modelId:e="",color:t=""}={}){i&&(w={modelId:e,color:t},i.classList.add("is-open"),document.body.style.overflow="hidden")}function b(){i&&(i.classList.remove("is-open"),document.body.style.overflow="",w={})}var T;(T=i==null?void 0:i.querySelector(".modal-close"))==null||T.addEventListener("click",b);i==null||i.addEventListener("click",e=>e.target===i&&b());document.addEventListener("keydown",e=>e.key==="Escape"&&(i==null?void 0:i.classList.contains("is-open"))&&b());d==null||d.addEventListener("submit",async e=>{if(e.preventDefault(),!d.checkValidity()){d.reportValidity();return}const t=new FormData(d),o={name:(t.get("name")||"").toString().trim(),phone:(t.get("phone")||"").toString().trim(),modelId:w.modelId,color:w.color,comment:(t.get("comment")||"").toString().trim()};console.log(o);try{const s=await fetch("https://furniture-store-v2.b.goit.study/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!s.ok){const n=await s.json().catch(()=>({}));f.error({title:"Помилка",message:n.message||`${s.status} ${s.statusText}`});return}const r=await s.json();f.success({title:"Успіх",message:`Замовлення прийнято. Номер: ${r.orderNum}`}),d.reset(),b()}catch(s){f.error({title:"Помилка мережі",message:s.message})}});document.addEventListener("DOMContentLoaded",()=>{"scrollRestoration"in history&&(history.scrollRestoration="manual"),window.scrollTo({top:0,left:0,behavior:"auto"})});const C="https://furniture-store-v2.b.goit.study/api",ne={soft:"М'які меблі",wardrobes:"Шафи та системи зберігання",beds:"Ліжка та матраци",tables:"Столи",chairs:"Стільці та табурети",kitchens:"Кухні",kids:"Меблі для дитячої",office:"Меблі для офісу",hallway:"Меблі для передпокою",bathroom:"Меблі для ванної кімнати",outdoor:"Садові та вуличні меблі",decor:"Декор та аксесуари"};function $(e){f.error({title:"Помилка",message:e,position:"topRight"})}function ie(){f.show({message:"Це всі товари у розділі «Всі товари».",position:"topRight"})}function ce(){const e=l&&l.children.length<a.total;u&&(u.hidden=!e)}function _(){g&&(g.hidden=!1),u&&(u.hidden=!0)}function k(){g&&(g.hidden=!0),ce()}let a={categoryId:"",page:1,limit:8,total:0};async function ae(){const{data:e}=await q.get(`${C}/categories`);return e}async function le(){const e={page:a.page,limit:a.limit};a.categoryId&&(e.category=a.categoryId);const{data:t}=await q.get(`${C}/furnitures`,{params:e});return t}const de=e=>new Intl.NumberFormat("uk-UA").format(e)+" грн",ue=e=>(e||[]).slice(0,3).map(t=>`<li class="color-dot" style="background:${t}"></li>`).join(""),me=({_id:e,name:t,images:o=[],price:s,color:r=[]})=>`
<li class="product-card" data-id="${e}">
  <div class="product-card__media">
    <img class="product-card__img" src="${o[0]||""}" alt="${t}" loading="lazy">
  </div>
  <div class="product-card__body">
    <h3 class="product-card__title" title="${t}">${t}</h3>
    <ul class="product-card__colors">${ue(r)}</ul>
    <p class="product-card__price">${de(s)}</p>
    <button class="product-card__btn" type="button">Детальніше</button>
  </div>
</li>`;async function pe(){const e=await ae(),t=Object.fromEntries(e.map(o=>[o.name,o._id]));E.querySelectorAll(".category-chip").forEach(o=>{var p;if(o.classList.contains("category-chip--all"))return;const s=(p=[...o.classList].find(O=>O.startsWith("category-chip--")))==null?void 0:p.replace("category-chip--",""),r=ne[s],n=o.querySelector(".furniture-categories__js");if(!r||!n){o.disabled=!0;return}n.textContent=r,o.dataset.categoryId=t[r]||""})}async function M(e=!0){const{furnitures:t,totalItems:o}=await le();a.total=o;const s=t.map(me).join("");e?l.innerHTML=s:l.insertAdjacentHTML("beforeend",s)}E.addEventListener("click",async e=>{const t=e.target.closest(".category-chip");if(t){E.querySelectorAll(".active-frame").forEach(o=>o.classList.remove("active-frame")),t.classList.add("active-frame"),a.categoryId=t.dataset.categoryId||"",a.page=1;try{_(),l.innerHTML="",await M(!0)}catch{$("Не вдалося завантажити товари цієї категорії. Спробуйте пізніше.")}finally{k()}}});u.addEventListener("click",async()=>{a.page+=1,u.disabled=!0,_();try{const e=l.children.length;await M(!1);const t=l.children[e];t&&t.scrollIntoView({behavior:"smooth",block:"start"}),l.children.length>=a.total&&a.categoryId===""&&ie()}catch{$("Не вдалося завантажити додаткові товари. Спробуйте знову.")}finally{u.disabled=!1,k()}});(async function(){try{_(),await pe(),await M(!0)}catch{$("Помилка ініціалізації. Оновіть сторінку або спробуйте пізніше.")}finally{k()}})();function fe(e){var s;h.classList.remove("is-close"),document.body.style.overflow="hidden",c.querySelector(".prod-name").textContent=e.name||"Без назви",c.querySelector(".prod-category").textContent=((s=e.category)==null?void 0:s.name)||"Категорія",c.querySelector(".prod-price").textContent=new Intl.NumberFormat("uk-UA").format(e.price||0)+" грн",c.querySelector(".prod-descr").textContent=e.description||"Опис відсутній",c.querySelector(".prod-size").textContent=e.size?`Розміри: ${e.size}`:"";const t=c.querySelector(".image-cont");t.innerHTML=(e.images||[]).slice(0,3).map(r=>`<img src="${r}" alt="${e.name}" class="image-modal">`).join("");const o=c.querySelector(".color-btns");o.innerHTML=(e.color||[]).slice(0,3).map((r,n)=>`<input class="color-btn" type="radio" name="product-color" value="${r}" ${n===0?"checked":""} style="background:${r}">`).join(""),e._id&&(c.dataset.modelId=e._id)}function v(){h.classList.add("is-close"),document.body.style.overflow=""}te.addEventListener("click",v);h.addEventListener("click",e=>{e.target===h&&v()});window.addEventListener("keydown",e=>{e.key==="Escape"&&v()});const S=c.querySelector(".modal-sub-btn");S==null||S.addEventListener("click",()=>{var o;const e=c.dataset.modelId;if(!e)return;const t=((o=c.querySelector('input[name="product-color"]:checked'))==null?void 0:o.value)||"";v(),se({modelId:e,color:t})});oe.addEventListener("click",async e=>{const t=e.target.closest(".product-card__btn");if(!t)return;const s=t.closest(".product-card").dataset.id;try{const n=await(await fetch(`https://furniture-store-v2.b.goit.study/api/furnitures/${s}`)).json();fe(n)}catch(r){console.error("Помилка при завантаженні даних продукту:",r)}});X();document.addEventListener("pointerdown",e=>{const t=e.target.closest(".button");t&&setTimeout(()=>t.blur(),0)});
//# sourceMappingURL=index.js.map
