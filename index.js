import{S as O,N as x,P as N,a as b,A as U,i as f}from"./assets/vendor-mUhAJKfp.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();const _="https://furniture-store-v2.b.goit.study/api/",L="/QuantumJS/assets/icons-fSjz1rIH.svg",m=document.querySelector(".header"),R=document.querySelector(".burger-btn"),V=document.querySelector(".close-btn"),z=document.querySelector(".close-btn-tablet"),F=document.querySelector(".overlay");document.querySelector(".js-review");document.querySelector(".review-stars");document.querySelector(".button-review-left");document.querySelector(".button-review-right");document.querySelector(".swiper-wrapper");const H=document.querySelector(".reviews__btn--next"),G=document.querySelector(".reviews__btn--prev"),W=document.querySelector(".reviews__pagination"),S=document.querySelector(".furniture-categories__list"),u=document.querySelector(".products-grid.furniture-list-js"),p=document.querySelector(".furniture__load-more"),g=document.querySelector("#loader"),h=document.querySelector(".prod-modal-overlay"),l=document.querySelector(".prod-modal-window"),J=document.querySelector(".close-modal-btn");document.querySelector(".modal-overlay");const j=document.querySelector(".popular-products__list"),P=document.querySelector(".popular-products__btn--prev"),M=document.querySelector(".popular-products__btn--next"),K=document.querySelector(".popular-products__pagination"),C=".reviews__container",Q=".reviews__list.js-review",X=document.querySelector(C),E=document.querySelector(Q),Y=`${_}${_.endsWith("/")?"":"/"}feedbacks`;function Z(e){const t=Number(e)||0;return t>3.3&&t<=3.7?3.5:t>=3.8&&t<=4.2?4:Math.round(t*2)/2}function D(e){return{rate:Z(e.rate??e.rating??e.stars??0),text:String(e.descr??e.comment??e.text??""),name:String(e.name??e.author??"Анонім")}}function ee(e){const t=Math.floor(e),r=e%1>=.5,n=5-t-(r?1:0);let o="";for(let s=0;s<t;s++)o+=`<svg width="20" height="20" class="star-icon"><use href="${L}#icon-star-fill"></use></svg>`;r&&(o+=`<svg width="20" height="20" class="star-icon"><use href="${L}#icon-star-half"></use></svg>`);for(let s=0;s<n;s++)o+=`<svg width="20" height="20" class="star-icon is-empty"><use href="${L}#icon-star-blank"></use></svg>`;return`<div class="review-stars" data-rating="${e}">${o}</div>`}const te=({rate:e,text:t,name:r})=>`
  <li class="review-exemplar swiper-slide">
    ${ee(e)}
    <p class="text-review">“${t}”</p>
    <p class="review-author">${r}</p>
  </li>
`;async function oe(e=10){try{const{data:t}=await b.get(Y,{params:{limit:e}}),r=(t==null?void 0:t.feedbacks)??(t==null?void 0:t.items)??(t==null?void 0:t.data)??t??[];return Array.isArray(r)?r.slice(0,e).map(D):[]}catch(t){return console.error("Помилка при завантаженні відгуків:",t),[]}}function re(e){E&&(E.innerHTML=e.length?e.map(te).join(""):`<li class="review-exemplar swiper-slide">
         <p class="text-review">Наразі відгуків немає.</p>
         <p class="review-author">—</p>
       </li>`)}async function se(){if(!X||!E)return;const e=await oe(10);re(e),new O(C,{modules:[x,N],slidesPerView:1,spaceBetween:24,loop:!1,navigation:{nextEl:H,prevEl:G},pagination:{el:W,clickable:!0,type:"bullets"},breakpoints:{768:{slidesPerView:2,slidesPerGroup:2,spaceBetween:24},1440:{slidesPerView:3,slidesPerGroup:3,spaceBetween:32}}})}m.addEventListener("click",ne);document.addEventListener("keydown",e=>{e.key==="Escape"&&m.classList.contains("menu-open")&&(m.classList.remove("menu-open"),document.body.classList.remove("no-scroll"))});function ne(e){if(R.contains(e.target))m.classList.add("menu-open"),document.body.classList.add("no-scroll");else if(V.contains(e.target)||z.contains(e.target)||F.contains(e.target))m.classList.remove("menu-open"),document.body.classList.remove("no-scroll");else return}window.addEventListener("resize",()=>{window.innerWidth>=1440&&m.classList.contains("menu-open")&&(m.classList.remove("menu-open"),document.body.classList.remove("no-scroll"))});document.addEventListener("DOMContentLoaded",()=>{new U("#faq-accordion",{duration:300,collapse:!0,showMultiple:!1,elementClass:"ac",triggerClass:"ac-trigger",panelClass:"ac-panel"})});function ce(e){var n;h.classList.remove("is-close"),document.body.style.overflow="hidden",l.querySelector(".prod-name").textContent=e.name||"Без назви",l.querySelector(".prod-category").textContent=((n=e.category)==null?void 0:n.name)||"Категорія",l.querySelector(".prod-price").textContent=new Intl.NumberFormat("uk-UA").format(e.price||0)+" грн",l.querySelector(".prod-descr").textContent=e.description||"Опис відсутній",l.querySelector(".prod-size").textContent=e.size?`Розміри: ${e.size}`:"";const t=l.querySelector(".image-cont");t.innerHTML=(e.images||[]).slice(0,3).map(o=>`<img src="${o}" alt="${e.name}" class="image-modal">`).join("");const r=l.querySelector(".color-btns");r.innerHTML=(e.color||[]).slice(0,3).map((o,s)=>`<input class="color-btn" type="radio" name="product-color" value="${o}" ${s===0?"checked":""} style="background:${o}">`).join(""),e._id&&(l.dataset.modelId=e._id)}function y(){h.classList.add("is-close"),document.body.style.overflow=""}J.addEventListener("click",y);h.addEventListener("click",e=>{e.target===h&&y()});window.addEventListener("keydown",e=>{e.key==="Escape"&&y()});[j,u].forEach(e=>{e&&e.addEventListener("click",t=>{const r=t.target.closest(".product-card__btn");if(!r)return;const o=r.closest(".product-card").dataset.id;fetch(`https://furniture-store-v2.b.goit.study/api/furnitures/${o}`).then(s=>s.json()).then(s=>ce(s)).catch(s=>console.error("Помилка при завантаженні даних продукту:",s))})});l.addEventListener("click",e=>{var n;if(!e.target.closest(".order-btn"))return;const t=l.dataset.modelId;if(!t)return;const r=((n=l.querySelector('input[name="product-color"]:checked'))==null?void 0:n.value)||"";y(),openOrderModal({modelId:t,color:r})});const c=document.querySelector(".modal-overlay"),i=c==null?void 0:c.querySelector(".modal-form");let v={};function ie({modelId:e="",color:t=""}={}){c&&(v={modelId:e,color:t},c.classList.add("is-open"),document.body.style.overflow="hidden")}function w(){c&&(c.classList.remove("is-open"),document.body.style.overflow="",v={},[...i.elements].forEach(e=>e.classList.remove("input-error")))}var T;(T=c==null?void 0:c.querySelector(".modal-close"))==null||T.addEventListener("click",w);c==null||c.addEventListener("click",e=>e.target===c&&w());document.addEventListener("keydown",e=>e.key==="Escape"&&(c==null?void 0:c.classList.contains("is-open"))&&w());document.addEventListener("click",e=>{var s,a;const t=e.target.closest(".modal-sub-btn");if(!t)return;y();const r=document.querySelector(".prod-modal-window"),n=(r==null?void 0:r.dataset.modelId)||t.dataset.modelId||"682f9bbf8acbdf505592ac42",o=((s=document.querySelector('input[name="product-color"]:checked'))==null?void 0:s.value)||"";(a=document.querySelector(".prod-modal-overlay"))==null||a.classList.remove("is-open"),ie({modelId:n,color:o})});[...i==null?void 0:i.elements].forEach(e=>{e.tagName!=="BUTTON"&&e.addEventListener("input",()=>e.classList.remove("input-error"))});i==null||i.addEventListener("submit",async e=>{e.preventDefault(),[...i.elements].forEach(o=>o.classList.remove("input-error"));let t=!1;if([...i.elements].forEach(o=>{o.tagName!=="BUTTON"&&!o.checkValidity()&&(o.classList.add("input-error"),t=!0)}),t){i.reportValidity();return}const r=new FormData(i),n={name:(r.get("name")||"").toString().trim(),phone:(r.get("phone")||"").toString().trim(),modelId:v.modelId,color:v.color,comment:(r.get("comment")||"").toString().trim()};console.log(n);try{const o=await fetch("https://furniture-store-v2.b.goit.study/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!o.ok){const a=await o.json().catch(()=>({}));f.error({title:"Помилка",message:a.message||`${o.status} ${o.statusText}`});return}const s=await o.json();f.success({title:"Успіх",message:`Замовлення прийнято. Номер: ${s.orderNum}`}),i.reset(),w()}catch(o){f.error({title:"Помилка мережі",message:o.message})}});document.addEventListener("DOMContentLoaded",()=>{"scrollRestoration"in history&&(history.scrollRestoration="manual"),window.scrollTo({top:0,left:0,behavior:"auto"})});const A="https://furniture-store-v2.b.goit.study/api",ae={soft:"М'які меблі",wardrobes:"Шафи та системи зберігання",beds:"Ліжка та матраци",tables:"Столи",chairs:"Стільці та табурети",kitchens:"Кухні",kids:"Меблі для дитячої",office:"Меблі для офісу",hallway:"Меблі для передпокою",bathroom:"Меблі для ванної кімнати",outdoor:"Садові та вуличні меблі",decor:"Декор та аксесуари"};function q(e){f.error({title:"Помилка",message:e,position:"topRight"})}function le(){f.show({message:"Це всі товари у розділі «Всі товари».",position:"topRight"})}function de(){const e=u&&u.children.length<d.total;p&&(p.hidden=!e)}function $(){g&&(g.hidden=!1),p&&(p.hidden=!0)}function k(){g&&(g.hidden=!0),de()}let d={categoryId:"",page:1,limit:8,total:0};async function ue(){const{data:e}=await b.get(`${A}/categories`);return e}async function pe(){const e={page:d.page,limit:d.limit};d.categoryId&&(e.category=d.categoryId);const{data:t}=await b.get(`${A}/furnitures`,{params:e});return t}const me=e=>new Intl.NumberFormat("uk-UA").format(e)+" грн",fe=e=>(e||[]).slice(0,3).map(t=>`<li class="color-dot" style="background:${t}"></li>`).join(""),ye=({_id:e,name:t,images:r=[],price:n,color:o=[]})=>`
<li class="product-card" data-id="${e}">
  <div class="product-card__media">
    <img class="product-card__img" src="${r[0]||""}" alt="${t}" loading="lazy">
  </div>
  <div class="product-card__body">
    <h3 class="product-card__title" title="${t}">${t}</h3>
    <ul class="product-card__colors">${fe(o)}</ul>
    <p class="product-card__price">${me(n)}</p>
    <button class="product-card__btn" type="button">Детальніше</button>
  </div>
</li>`;async function ge(){const e=await ue(),t=Object.fromEntries(e.map(r=>[r.name,r._id]));S.querySelectorAll(".category-chip").forEach(r=>{var a;if(r.classList.contains("category-chip--all"))return;const n=(a=[...r.classList].find(B=>B.startsWith("category-chip--")))==null?void 0:a.replace("category-chip--",""),o=ae[n],s=r.querySelector(".furniture-categories__js");if(!o||!s){r.disabled=!0;return}s.textContent=o,r.dataset.categoryId=t[o]||""})}async function I(e=!0){const{furnitures:t,totalItems:r}=await pe();d.total=r;const n=t.map(ye).join("");e?u.innerHTML=n:u.insertAdjacentHTML("beforeend",n)}S.addEventListener("click",async e=>{const t=e.target.closest(".category-chip");if(t){S.querySelectorAll(".active-frame").forEach(r=>r.classList.remove("active-frame")),t.classList.add("active-frame"),d.categoryId=t.dataset.categoryId||"",d.page=1;try{$(),u.innerHTML="",await I(!0)}catch{q("Не вдалося завантажити товари цієї категорії. Спробуйте пізніше.")}finally{k()}}});p.addEventListener("click",async()=>{d.page+=1,p.disabled=!0,$();try{const e=u.children.length;await I(!1);const t=u.children[e];t&&t.scrollIntoView({behavior:"smooth",block:"start"}),u.children.length>=d.total&&d.categoryId===""&&le()}catch{q("Не вдалося завантажити додаткові товари. Спробуйте знову.")}finally{p.disabled=!1,k()}});(async function(){try{$(),await ge(),await I(!0)}catch{q("Помилка ініціалізації. Оновіть сторінку або спробуйте пізніше.")}finally{k()}})();const he=e=>new Intl.NumberFormat("uk-UA").format(e)+" грн",ve=e=>(e||[]).slice(0,3).map(t=>`<li class="color-dot" style="background:${t}"></li>`).join(""),be=({_id:e,name:t,images:r=[],price:n,color:o=[]})=>`
<li class="swiper-slide product-card" data-id="${e}">
  <div class="product-card__media">
    <img class="product-card__img" src="${r[0]||""}" alt="${t}" loading="lazy">
  </div>
  <div class="product-card__body">
    <h3 class="product-card__title" title="${t}">${t}</h3>
    <ul class="product-card__colors">${ve(o)}</ul>
    <p class="product-card__price">${he(n)}</p>
    <button class="product-card__btn" type="button">Детальніше</button>
  </div>
</li>`;async function we(){const{data:e}=await b.get(`${_}furnitures?type=popular`);return e.furnitures||[]}async function Le(){try{const e=await we();if(!e.length)return;j.innerHTML=e.map(be).join("");const t=new O(".popular-products__container",{modules:[x,N],slidesPerView:1,spaceBetween:10,navigation:{nextEl:M,prevEl:P},pagination:{el:K,clickable:!0,type:"bullets"},breakpoints:{768:{slidesPerView:2,slidesPerGroup:2,spaceBetween:16},1440:{slidesPerView:4,slidesPerGroup:4,spaceBetween:24}},on:{slideChange:function(){P.disabled=this.isBeginning,M.disabled=this.isEnd}}})}catch(e){console.error("Помилка завантаження популярних товарів:",e)}}document.addEventListener("DOMContentLoaded",Le);se();document.addEventListener("pointerdown",e=>{const t=e.target.closest(".button");t&&setTimeout(()=>t.blur(),0)});
//# sourceMappingURL=index.js.map
