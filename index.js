import{S as C,N as T,P as A,a as b,A as B,i as f}from"./assets/vendor-mUhAJKfp.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const m of n.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&s(m)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();const E="https://furniture-store-v2.b.goit.study/api/",L="/QuantumJS/assets/icons-fSjz1rIH.svg",p=document.querySelector(".header"),R=document.querySelector(".burger-btn"),z=document.querySelector(".close-btn"),U=document.querySelector(".close-btn-tablet"),F=document.querySelector(".overlay");document.querySelector(".js-review");document.querySelector(".review-stars");document.querySelector(".button-review-left");document.querySelector(".button-review-right");document.querySelector(".swiper-wrapper");const H=document.querySelector(".reviews__btn--next"),W=document.querySelector(".popular-products__btn--prev"),G=document.querySelector(".reviews__btn--prev"),$=document.querySelector(".furniture-categories__list"),l=document.querySelector(".products-grid.furniture-list-js"),u=document.querySelector(".furniture__load-more"),y=document.querySelector("#loader"),g=document.querySelector(".prod-modal-overlay"),i=document.querySelector(".prod-modal-window"),J=document.querySelector(".close-modal-btn"),K=document.querySelector(".products-grid.furniture-list-js");document.querySelector(".modal-overlay");const Q=document.querySelector(".popular-products__list"),_=document.querySelector(".popular-products__btn--prev"),S=document.querySelector(".popular-products__btn--next"),X=document.querySelector(".popular-products__pagination"),O=".reviews__container",Y=".reviews__list.js-review",Z=document.querySelector(O),k=document.querySelector(Y),D=`${E}${E.endsWith("/")?"":"/"}feedbacks`;function ee(e){const t=Number(e)||0;return t>3.3&&t<=3.7?3.5:t>=3.8&&t<=4.2?4:Math.round(t*2)/2}function te(e){return{rate:ee(e.rate??e.rating??e.stars??0),text:String(e.descr??e.comment??e.text??""),name:String(e.name??e.author??"Анонім")}}function oe(e){const t=Math.floor(e),r=e%1>=.5,s=5-t-(r?1:0);let o="";for(let n=0;n<t;n++)o+=`<svg width="20" height="20" class="star-icon"><use href="${L}#icon-star-fill"></use></svg>`;r&&(o+=`<svg width="20" height="20" class="star-icon"><use href="${L}#icon-star-half"></use></svg>`);for(let n=0;n<s;n++)o+=`<svg width="20" height="20" class="star-icon is-empty"><use href="${L}#icon-star-blank"></use></svg>`;return`<div class="review-stars" data-rating="${e}">${o}</div>`}const re=({rate:e,text:t,name:r})=>`
  <li class="review-exemplar swiper-slide">
    ${oe(e)}
    <p class="text-review">“${t}”</p>
    <p class="review-author">${r}</p>
  </li>
`;async function se(e=10){try{const{data:t}=await b.get(D,{params:{limit:e}}),r=(t==null?void 0:t.feedbacks)??(t==null?void 0:t.items)??(t==null?void 0:t.data)??t??[];return Array.isArray(r)?r.slice(0,e).map(te):[]}catch(t){return console.error("Помилка при завантаженні відгуків:",t),[]}}function ne(e){k&&(k.innerHTML=e.length?e.map(re).join(""):`<li class="review-exemplar swiper-slide">
         <p class="text-review">Наразі відгуків немає.</p>
         <p class="review-author">—</p>
       </li>`)}async function ce(){if(!Z||!k)return;const e=await se(10);ne(e),new C(O,{modules:[T,A],slidesPerView:1,spaceBetween:24,loop:!1,navigation:{nextEl:H,prevEl:W},pagination:{el:G,clickable:!0,type:"bullets"},breakpoints:{768:{slidesPerView:2,slidesPerGroup:2,spaceBetween:24},1440:{slidesPerView:3,slidesPerGroup:3,spaceBetween:32}}})}p.addEventListener("click",ie);document.addEventListener("keydown",e=>{e.key==="Escape"&&p.classList.contains("menu-open")&&(p.classList.remove("menu-open"),document.body.classList.remove("no-scroll"))});function ie(e){if(R.contains(e.target))p.classList.add("menu-open"),document.body.classList.add("no-scroll");else if(z.contains(e.target)||U.contains(e.target)||F.contains(e.target))p.classList.remove("menu-open"),document.body.classList.remove("no-scroll");else return}window.addEventListener("resize",()=>{window.innerWidth>=1440&&p.classList.contains("menu-open")&&(p.classList.remove("menu-open"),document.body.classList.remove("no-scroll"))});document.addEventListener("DOMContentLoaded",()=>{new B("#faq-accordion",{duration:300,collapse:!0,showMultiple:!1,elementClass:"ac",triggerClass:"ac-trigger",panelClass:"ac-panel"})});const c=document.querySelector(".modal-overlay"),d=c==null?void 0:c.querySelector(".modal-form");let h={};function ae({modelId:e="",color:t=""}={}){c&&(h={modelId:e,color:t},c.classList.add("is-open"),document.body.style.overflow="hidden")}function v(){c&&(c.classList.remove("is-open"),document.body.style.overflow="",h={})}var x;(x=c==null?void 0:c.querySelector(".modal-close"))==null||x.addEventListener("click",v);c==null||c.addEventListener("click",e=>e.target===c&&v());document.addEventListener("keydown",e=>e.key==="Escape"&&(c==null?void 0:c.classList.contains("is-open"))&&v());d==null||d.addEventListener("submit",async e=>{if(e.preventDefault(),!d.checkValidity()){d.reportValidity();return}const t=new FormData(d),r={name:(t.get("name")||"").toString().trim(),phone:(t.get("phone")||"").toString().trim(),modelId:h.modelId,color:h.color,comment:(t.get("comment")||"").toString().trim()};console.log(r);try{const s=await fetch("https://furniture-store-v2.b.goit.study/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok){const n=await s.json().catch(()=>({}));f.error({title:"Помилка",message:n.message||`${s.status} ${s.statusText}`});return}const o=await s.json();f.success({title:"Успіх",message:`Замовлення прийнято. Номер: ${o.orderNum}`}),d.reset(),v()}catch(s){f.error({title:"Помилка мережі",message:s.message})}});document.addEventListener("DOMContentLoaded",()=>{"scrollRestoration"in history&&(history.scrollRestoration="manual"),window.scrollTo({top:0,left:0,behavior:"auto"})});const N="https://furniture-store-v2.b.goit.study/api",le={soft:"М'які меблі",wardrobes:"Шафи та системи зберігання",beds:"Ліжка та матраци",tables:"Столи",chairs:"Стільці та табурети",kitchens:"Кухні",kids:"Меблі для дитячої",office:"Меблі для офісу",hallway:"Меблі для передпокою",bathroom:"Меблі для ванної кімнати",outdoor:"Садові та вуличні меблі",decor:"Декор та аксесуари"};function P(e){f.error({title:"Помилка",message:e,position:"topRight"})}function de(){f.show({message:"Це всі товари у розділі «Всі товари».",position:"topRight"})}function ue(){const e=l&&l.children.length<a.total;u&&(u.hidden=!e)}function M(){y&&(y.hidden=!1),u&&(u.hidden=!0)}function I(){y&&(y.hidden=!0),ue()}let a={categoryId:"",page:1,limit:8,total:0};async function pe(){const{data:e}=await b.get(`${N}/categories`);return e}async function me(){const e={page:a.page,limit:a.limit};a.categoryId&&(e.category=a.categoryId);const{data:t}=await b.get(`${N}/furnitures`,{params:e});return t}const fe=e=>new Intl.NumberFormat("uk-UA").format(e)+" грн",ye=e=>(e||[]).slice(0,3).map(t=>`<li class="color-dot" style="background:${t}"></li>`).join(""),ge=({_id:e,name:t,images:r=[],price:s,color:o=[]})=>`
<li class="product-card" data-id="${e}">
  <div class="product-card__media">
    <img class="product-card__img" src="${r[0]||""}" alt="${t}" loading="lazy">
  </div>
  <div class="product-card__body">
    <h3 class="product-card__title" title="${t}">${t}</h3>
    <ul class="product-card__colors">${ye(o)}</ul>
    <p class="product-card__price">${fe(s)}</p>
    <button class="product-card__btn" type="button">Детальніше</button>
  </div>
</li>`;async function he(){const e=await pe(),t=Object.fromEntries(e.map(r=>[r.name,r._id]));$.querySelectorAll(".category-chip").forEach(r=>{var m;if(r.classList.contains("category-chip--all"))return;const s=(m=[...r.classList].find(V=>V.startsWith("category-chip--")))==null?void 0:m.replace("category-chip--",""),o=le[s],n=r.querySelector(".furniture-categories__js");if(!o||!n){r.disabled=!0;return}n.textContent=o,r.dataset.categoryId=t[o]||""})}async function j(e=!0){const{furnitures:t,totalItems:r}=await me();a.total=r;const s=t.map(ge).join("");e?l.innerHTML=s:l.insertAdjacentHTML("beforeend",s)}$.addEventListener("click",async e=>{const t=e.target.closest(".category-chip");if(t){$.querySelectorAll(".active-frame").forEach(r=>r.classList.remove("active-frame")),t.classList.add("active-frame"),a.categoryId=t.dataset.categoryId||"",a.page=1;try{M(),l.innerHTML="",await j(!0)}catch{P("Не вдалося завантажити товари цієї категорії. Спробуйте пізніше.")}finally{I()}}});u.addEventListener("click",async()=>{a.page+=1,u.disabled=!0,M();try{const e=l.children.length;await j(!1);const t=l.children[e];t&&t.scrollIntoView({behavior:"smooth",block:"start"}),l.children.length>=a.total&&a.categoryId===""&&de()}catch{P("Не вдалося завантажити додаткові товари. Спробуйте знову.")}finally{u.disabled=!1,I()}});(async function(){try{M(),await he(),await j(!0)}catch{P("Помилка ініціалізації. Оновіть сторінку або спробуйте пізніше.")}finally{I()}})();function be(e){var s;g.classList.remove("is-close"),document.body.style.overflow="hidden",i.querySelector(".prod-name").textContent=e.name||"Без назви",i.querySelector(".prod-category").textContent=((s=e.category)==null?void 0:s.name)||"Категорія",i.querySelector(".prod-price").textContent=new Intl.NumberFormat("uk-UA").format(e.price||0)+" грн",i.querySelector(".prod-descr").textContent=e.description||"Опис відсутній",i.querySelector(".prod-size").textContent=e.size?`Розміри: ${e.size}`:"";const t=i.querySelector(".image-cont");t.innerHTML=(e.images||[]).slice(0,3).map(o=>`<img src="${o}" alt="${e.name}" class="image-modal">`).join("");const r=i.querySelector(".color-btns");r.innerHTML=(e.color||[]).slice(0,3).map((o,n)=>`<input class="color-btn" type="radio" name="product-color" value="${o}" ${n===0?"checked":""} style="background:${o}">`).join(""),e._id&&(i.dataset.modelId=e._id)}function w(){g.classList.add("is-close"),document.body.style.overflow=""}J.addEventListener("click",w);g.addEventListener("click",e=>{e.target===g&&w()});window.addEventListener("keydown",e=>{e.key==="Escape"&&w()});const q=i.querySelector(".modal-sub-btn");q==null||q.addEventListener("click",()=>{var r;const e=i.dataset.modelId;if(!e)return;const t=((r=i.querySelector('input[name="product-color"]:checked'))==null?void 0:r.value)||"";w(),ae({modelId:e,color:t})});K.addEventListener("click",async e=>{const t=e.target.closest(".product-card__btn");if(!t)return;const s=t.closest(".product-card").dataset.id;try{const n=await(await fetch(`https://furniture-store-v2.b.goit.study/api/furnitures/${s}`)).json();be(n)}catch(o){console.error("Помилка при завантаженні даних продукту:",o)}});const ve=e=>new Intl.NumberFormat("uk-UA").format(e)+" грн",we=e=>(e||[]).slice(0,3).map(t=>`<li class="color-dot" style="background:${t}"></li>`).join(""),Le=({_id:e,name:t,images:r=[],price:s,color:o=[]})=>`
<li class="swiper-slide product-card" data-id="${e}">
  <div class="product-card__media">
    <img class="product-card__img" src="${r[0]||""}" alt="${t}" loading="lazy">
  </div>
  <div class="product-card__body">
    <h3 class="product-card__title" title="${t}">${t}</h3>
    <ul class="product-card__colors">${we(o)}</ul>
    <p class="product-card__price">${ve(s)}</p>
    <button class="product-card__btn" type="button">Детальніше</button>
  </div>
</li>`;async function _e(){const{data:e}=await b.get(`${E}furnitures?type=popular`);return e.furnitures||[]}async function Se(){try{const e=await _e();if(!e.length)return;Q.innerHTML=e.map(Le).join("");const t=new C(".popular-products__container",{modules:[T,A],slidesPerView:4,spaceBetween:20,navigation:{nextEl:S,prevEl:_},pagination:{el:X,clickable:!0,type:"bullets"},breakpoints:{0:{slidesPerView:1},768:{slidesPerView:2},1024:{slidesPerView:4}},on:{slideChange:function(){_.disabled=this.isBeginning,S.disabled=this.isEnd}}});_.disabled=!0,S.disabled=e.length<=t.params.slidesPerView}catch(e){console.error("Помилка завантаження популярних товарів:",e)}}document.addEventListener("DOMContentLoaded",Se);ce();document.addEventListener("pointerdown",e=>{const t=e.target.closest(".button");t&&setTimeout(()=>t.blur(),0)});
//# sourceMappingURL=index.js.map
